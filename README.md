# 💰 정산 시스템 v4

SQLite 기반의 모바일 친화적 정산 관리 시스템입니다.

## 🚀 주요 기능

### 📝 거래 입력
- **거래 정보 관리**: 설명, 금액, 날짜 입력
- **참여자 관리**: 참여자 추가/삭제, 개별 금액 설정
- **실시간 계산**: 참여자별 금액 자동 계산 및 검증
- **거래 수정**: 기존 거래 내역 수정 및 삭제

### 🧮 정산 결과
- **자동 정산**: 전체 거래 기반 자동 정산 계산
- **상세 분석**: 참여자별 지출, 평균 금액, 정산 금액 표시
- **정산 저장**: 정산 결과를 이름과 날짜와 함께 저장
- **자동 초기화**: 정산 저장 후 거래 내역 자동 초기화

### 📚 정산 기록
- **과거 기록 조회**: 저장된 모든 정산 내역 확인
- **상세 정보**: 각 정산의 참여자별 상세 내역
- **안전한 삭제**: 2단계 확인을 통한 안전한 기록 삭제

## 🛠️ 기술 스택

- **Frontend**: Streamlit
- **Database**: SQLite
- **Language**: Python 3.8+
- **UI**: 반응형 디자인 (모바일 최적화)

## 📦 설치 및 실행

### 1. 저장소 클론
```bash
git clone <repository-url>
cd settlement_system
```

### 2. 의존성 설치
```bash
pip install -r requirements.txt
```

### 3. 애플리케이션 실행
```bash
streamlit run settlement_app.py
```

## 🗄️ 데이터베이스 구조

### transactions 테이블
- `id`: 고유 식별자
- `date`: 거래 날짜
- `description`: 거래 설명
- `amount`: 총 금액
- `members`: 참여자 목록 (JSON)
- `member_amounts`: 참여자별 금액 (JSON)
- `created_at`: 생성 시간
- `updated_at`: 수정 시간

### settlements 테이블
- `id`: 고유 식별자
- `name`: 정산 이름
- `date`: 정산 날짜
- `total_amount`: 총 금액
- `member_count`: 참여자 수
- `settlement_data`: 정산 데이터 (JSON)
- `created_at`: 생성 시간

## 📱 사용 방법

### 1. 거래 입력
1. **거래 정보 입력**: 설명, 금액, 날짜 입력
2. **참여자 추가**: 참여자 이름 입력 후 추가
3. **개별 금액 설정**: 참여자별 금액 조정 (선택사항)
4. **거래 저장**: 모든 정보 입력 후 저장

### 2. 정산 결과 확인
1. **정산 결과 탭**으로 이동
2. **전체 요약** 확인: 총 금액, 평균 금액, 참여자 수
3. **참여자별 상세** 확인: 개별 정산 금액 및 거래 내역

### 3. 정산 결과 저장
1. **정산 이름** 입력 (예: "2024년 1월 정산")
2. **정산 날짜** 설정
3. **"💾 정산 결과 저장"** 버튼 클릭
4. **자동 초기화**: 거래 내역이 자동으로 초기화됨

### 4. 정산 기록 관리
1. **정산 기록 탭**으로 이동
2. **과거 정산** 조회 및 상세 확인
3. **삭제**: 필요시 2단계 확인을 통해 안전하게 삭제

## 🎨 UI 특징

### 모바일 최적화
- **반응형 디자인**: 모바일/태블릿/데스크톱 지원
- **터치 친화적**: 큰 버튼과 터치 영역
- **직관적 인터페이스**: 이모지와 색상으로 직관적 표현

### 시각적 개선
- **그라데이션 카드**: 메트릭 카드에 그라데이션 배경
- **호버 효과**: 마우스 오버 시 부드러운 애니메이션
- **상태 표시**: 성공/오류 상태를 색상으로 구분

## 🔒 안전 기능

### 데이터 보호
- **2단계 삭제**: 정산 기록 삭제 시 확인 절차
- **실수 방지**: 중요한 작업에 확인 메시지
- **데이터 백업**: SQLite 파일로 데이터 영구 저장

### 사용자 경험
- **실시간 검증**: 금액 불일치 시 즉시 경고
- **자동 초기화**: 작업 완료 후 깔끔한 상태로 리셋
- **명확한 피드백**: 모든 작업에 대한 명확한 결과 표시

## 📊 정산 로직

### 기본 원리
1. **총 지출 계산**: 모든 거래의 총 금액
2. **평균 금액 계산**: 총 지출 ÷ 참여자 수
3. **개별 정산**: 평균 금액 - 개인 지출

### 예시
- 총 지출: 30,000원
- 참여자: 3명
- 평균 금액: 10,000원
- A 지출: 15,000원 → 정산: -5,000원 (받을 금액)
- B 지출: 8,000원 → 정산: +2,000원 (낼 금액)
- C 지출: 7,000원 → 정산: +3,000원 (낼 금액)

## 🚀 배포

### Streamlit Cloud 배포
1. GitHub 저장소에 코드 푸시
2. [Streamlit Cloud](https://streamlit.io/cloud)에서 새 앱 생성
3. 저장소 연결 및 `simple_settlement_v4.py` 파일 지정
4. 자동 배포 완료

### 로컬 배포
```bash
# 개발 서버 실행
streamlit run settlement_app.py --server.port 8501

# 프로덕션 배포 (예: Docker)
docker build -t settlement-system .
docker run -p 8501:8501 settlement-system
```

## 📝 버전 히스토리

### v4.0 (현재)
- ✅ SQLite 데이터베이스 연동
- ✅ 정산 결과 저장 기능
- ✅ 정산 기록 조회 및 삭제
- ✅ 모바일 최적화 UI
- ✅ 2단계 삭제 확인

### v3.0
- ✅ 모바일 친화적 UI
- ✅ 입력 필드 초기화 개선
- ✅ 시각적 개선

### v2.0
- ✅ 참여자별 금액 수정 기능
- ✅ 거래 수정/삭제 기능

### v1.0
- ✅ 기본 정산 기능
- ✅ 거래 입력 및 저장

## 🤝 기여하기

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## 📄 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다. 자세한 내용은 `LICENSE` 파일을 참조하세요.

## 📞 문의

프로젝트에 대한 질문이나 제안사항이 있으시면 이슈를 생성해 주세요.

---

**⭐ 이 프로젝트가 도움이 되었다면 스타를 눌러주세요!** 